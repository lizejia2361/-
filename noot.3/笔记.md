第9章  组合电路设计
9.1引言
数字逻辑可以分为组合电路和时序电路组合电路的输出，仅取决于他当前的输入，而时序电路具有存储元件，一般来说构成组合电路基本模块是逻辑门，而构成时序电路的基本模块是寄存器和锁存器。本章我们将研究用来优化组合电路，使它具有低延时或低能耗的技术。
对于同样的尺寸和电容，nMOS管能比pMOS管提供更大的电流。
静态CMOS电路的一个缺点是它的每个输入端上同时要求有nMOS管和pMOS管，而它的另一个缺点是所有的节点电压必须在零和vdd之间翻转。
9.2电路系列
绝大多数逻辑门都采用NMOS下拉网络和PMOS上拉网络的静态CMOS电路，他们具有良好的噪声容限，足够快，功耗低，对器件扰动不敏感，且易于设计。
静态CMOS：与,或—>与非，或非。CMOS门在本质上是反向位的，因此与和或的功能必须通过与非门和或非门来实现。一般来说，我们定义外层输入，为靠近电源轨线的输入而内层输入，为靠近输出端的输入，当内存输入最后翻转时，寄生延时最小，因为中间节点早已放电，因此如果已知一个信号比其他信号迟到达，那么当这个信号连接到内存输入端时，逻辑门的速度最快。不对称门可以实现让晚到的信号快过早到的信号。
偏斜门：一个单元库的偏斜比，应当根据面积，功耗和可靠性，而不是根据平均延时来选择
多阀值电压：具有较低阀值电压的晶体管能提供较大的导通电流，但在关断时，也具有按指数关系增长的较大的泄漏电流。
有比电路：伪nMOS，对于与非门结构平均来说，伪nMOS比静态CMOS慢，但伪nMOS用来构成或非结构时性能较好。（复制偏置的伪nMOS详见285）





9-2.2共输出CMOS
输出端连在一起的一对CMOS反向器，这样的电路常常称为对称或非门或更一般的称为共输出CMOS。当一个输入为零，而另一个输入为一时，此门在满足正确尺寸比的约束条件下，可以看成一个伪nMOS电路，当两个输入都为零时，两个pMOS管并联导通，此时将输出上拉至高电平的速度，要比他们在通常的伪nMOS门中更快，同时，当两个输入都为一时，两个pMOS管都变为截止，因而没有静态功耗，因此，这一对称或非门比起一个两输入的伪nMOS或非门来能同时实现较高的性能和较低的功耗。
9-2.3串联电压开关逻辑
该逻辑试图利用有比电路的优点，但又希望没有静态功耗。他接收一组互补的输入信号，并利用一对nMOS下拉网络，同时计算出两个互补的输出。(CVSL门原理)
    CVSL具有潜在的速度优势，因为所有的逻辑都由nMOS管实现，因而减少了输入电容与在伪nMOS中一样，CVSL中pMOS管的尺寸非常重要，尺寸小的pMOS管会使互补输出在被拉高时变慢。伪nMOS在实现宽或非结构时，性能很好。但由于CVSL相互的晶体管堆叠很高，因而速度很慢的与非结构，因此CVSL不适于用来实现通常的与非和或非逻辑。
9-2.4 动态电路
  有比电路的缺点，包括上升，跳变较慢，下降，跳变时的竞争，静态，功耗及Vol不为零等，动态电路采用时钟控制的上拉晶体管，而不是总是导通的pMOS管，从而克服了这些缺点。（静态CMOS反向器伪nMOS反向器，动态反向器的比较）动态门的逻辑努力很小。动态电路一个最基本的难点是，他要求输入的单调性，即动态门在求值时输入必须单调上升。
多米诺门：多米诺门在本质上是非反向的，但某些函数如意或门必须要有反向，有三种方法可以解决这个问题，即将反向功能放到静态逻辑中去实现，采用延时时钟或采用双轨多米诺逻辑。
保持器：增加一个保持器电路可以解决泄漏和噪声容限的问题。
  动态门由于采用nMOS管构造逻辑，因而速度较快，而且他的逻辑努力很小，这意味着采用较多数目的级数比较有利，将逻辑功能集成到静态CMOS级中会用到速度较慢的pMOS管，并使逻辑级数减少，因此通常只在电气努力较小的路径上采用静态CMOS门才有优势。
多输出多米诺逻辑，NP和拉链式多米诺没看。
9-2.5传输管电路
1.含传输门的CMOS电路：三态电路锁存器及多路开关这样的结构常常设计成传输门和简单静态CMOS逻辑的组合。
注意：有几个理由使人们优先选择静态CMOS形式，而不是含传输门的CMOS电路，再含传输门的CMOS中，如果反向器放在门的输出端，而不是在输入端，那么门延时不仅取决于有输出端所驱动的电容大小，也取决于驱动输入端的驱动器。
2.互补传输管逻辑（cpl
）
   9.3电路隐患
电路隐患包括以下几种:
阈值损失，比值失效，泄漏电流，电荷分享，电源噪声，偶合，少数载流子注入，背栅偶合，扩散区输入的噪声敏感性，竞争条件，延时匹配，亚稳态，热斑，软错，工艺敏感性。
阈值损失：每类传输管都有一种逻辑电平，他能传送的很好，而在传送另一种逻辑电瓶时，他输出的幅度最好情况下也与轨线电平相差一个v
比值失效：伪nMOS电路存在比值约束问题，它发生在一个节点，同时被上拉和下拉的时候，这一问题在有扩散区输入的情形下尤其敏感。
泄漏电流：泄漏电流来自亚域值导电，栅级隧穿及反偏二极管漏电，特别是对于动态节点和宽或非结构。
电源噪声：在面积很大的芯片上，vdd和gnd并不是恒定不变，它们会受ir压降引起的电源噪声的影响。电源噪声将降低性能并可能减少噪声容限。电源噪声同时引起噪声容线问题和延时扰动，为了解决噪声容线问题，可以将敏感电路相互靠近放在一起，并使他们共享一条公共的低阻电源线。
9.4其他电路系列
9.5，绝缘体上硅的电路设计（粗略看看）
 浮体电压，so I，的优点，so I的缺点，对电路风格的影响。
9.6（亚域值电路设计）
最小能耗点通常发生在vdd小于VI的情况下，这种工作情况称为亚域值区，在亚域之区，岩石随电源电压的降低而呈指数增大。
6.1，晶体管尺寸的确定
  晶体管尺寸的选择，最多只能使性能有线性关系的改善，而电源电压的选择可以使性能有指数关系的改善。为了在性能约束条件下达到最小的能耗，可以采用最小宽度的晶体管，然后在必要时可将电源电压从最小能耗点起提高，直到满足性能要求为止。采用最小宽度的晶体管尺寸时，连线电容很可能占据整个翻转电容的大部分，为了缩短连线亚预值单元，应当尽可能小单元高度一般有触发器的最小高度决定，而良好的平面规划和布局是必不可少的。
6.2门的选择原则
9.7常见隐患与误区
1.没有考虑工艺进展的影响；
2.表征传输管电路时忽略了驱动器的电阻
3.只报告电路的部分延时
4.对性能做出完全不切实际的评价。
5.设计电路时没有合适的验证工具。
6.只通过加大亚阈值电路的尺寸来提高速度。


深度学习是什么：深度学习（DL，Deep Learning）是机器学习（ML，Machine Learning）领域中一个新的研究方向，它被引入机器学习使其更接近于最初的目标——人工智能（AI，Artificial Intelligence）。 [1]深度学习是学习样本数据的内在规律和表示层次，这些学习过程中获得的信息对诸如文字、图像和声音等数据的解释有很大的帮助。它的最终目标是让机器能够像人一样具有分析学习能力，能够识别文字、图像和声音等数据。 深度学习是一个复杂的机器学习算法，在语音和图像识别方面取得的效果，远远超过先前相关技术。 [1]深度学习在搜索技术、数据挖掘、机器学习、机器翻译、自然语言处理、多媒体学习、语音、推荐和个性化技术，以及其他相关领域都取得了很多成果。深度学习使机器模仿视听和思考等人类的活动，解决了很多复杂的模式识别难题，使得人工智能相关技术取得了很大进步。

电涌是什么：电涌顾名思义就是超出正常工作电压的瞬间过电压，被称为瞬变脉冲电压、瞬态过电、突波或电涌等，是电路中出现的一种短暂的电流、电压波动，在电路中通常持续约百万分之一秒的一种剧烈脉冲。

逻辑努力：逻辑努力(Logical Effort)是描述逻辑门的特性以及它们如何在逻辑链中相互作用，并且提供使延时最小的技术。门的逻辑努力g：一个逻辑门与参照门提供相同的输出电流时，该逻辑门的输入电容与参照门输入电容的比值。

寄生电容：寄生的含义就是本来没有在那个地方设计电容，但由于布线之间总是有互容，互容就好像是寄生在布线之间的一样，所以叫寄生电容，又称杂散电容。



第十章  时序电路设计
 10.1 引言
    时序电路中输出不仅取决于当前的输入，还取决于以前的输入，这样的电路称为具有状态，有限状态机和流水线是两种最重要的时序电路例子。
    时序电路通常采用触发器或锁存器设计，他们常称为存储元件，而他们所保持的数据称为令牌。这些元件的作用并不是真正的存储器，而是强制实施顺序，防止时序混乱，遗憾的是，失去元件不可避免的会在本来就很关键的令牌路径上增加延迟，因而降低了系统的性能，这一延时称为时序开销。
10.2静态电路的时序控制
   锁存器和触发器是最常用的时序元件，他们都有三个终端数据输入时钟和数据输出。锁存器在时钟为高电平时透明，而在时钟为低电平时不透明（高电平时相当于缓冲器，低电平时输入到不了输出）
10.2.1时序控制方法
    以触发器为基础的系统在每个时钟周期边界上采用一个触发器。数据令牌在时钟上升延时，从一个周期传送到下一个周期，如果令牌来的太早，就会在触发器处等待，触发器可以看成是一对前后直接连接锁存器。
  为了使触发器能可靠采样数据输入，必须在触发器上升沿附近的某个时间窗口内保持稳定。即输入必须在时钟上升，沿的某个时间段之前就已经稳定，并且在时钟上升沿之后的一段保持时间内不应当再次变化。
10.2.2最大延时约束
    如果组合逻辑的延时太大，那么接收元件应没有充分的建立时间而将采用错误的数值，这称为建立时间时效。他可以通过重新设计逻辑，使逻辑速度加快或通过加长时钟周期来解决。
10.2.3最小延时约束
    如果寄存器的保持时间很大，而污染延时很小，那么数据有可能错误的在同一时钟延时连续传播，通过前后两个时序元件，从而破坏了系统应有的状态，这称为竞争条件或最小延时失效。但他只能通过重新设计逻辑，而不能通过减慢时钟来解决。可以通过在触发器之间直接增加延时，例如插入缓冲器或在需要前后直接连接触发器的路径上采用特殊的，污染延时比普通触发器更长的慢触发器。
10.2.4时间借用
    当系统采用透明锁存器时，数据可以在时钟上升，沿时从第一个锁存器出发，但它只需要在时钟下降，沿之前在接收锁存器中建立起来，而不会像采用非透明触发器的系统中那样被挡住。如果一条流水线的某个半周期或某一流水极有太多的逻辑，那么他可以借用下半个周期或下一级的时间。
10.2.5时钟偏斜
    我们一直假设时钟是理想时钟，但在实际中，时钟在他们的到达时间上有某种不确定性，因而有可能减少可用于计算时间。在采用透明锁存器的系统中，时钟偏斜不降低性能。
10.3锁存器和触发器的电路设计
3.1，3.2传统的触发器和锁存器
3.3脉冲锁存器
  脉冲锁存器比常规的触发器快，因为它只采用一个，而不是两个锁存器，并且它允许时间借用虽然它的脉冲发生器会增加能耗，但他的能耗人较少，他的缺点是增加了保持时间。
3.4可复位锁存器和触发器
    复位可分为两类，同步复位和异步复位，异步复位能强制使输出立即变为低电平而同步复位，需要等待时钟到来之后才起作用。可置位锁存器和触发器强制使输出变为高电平，而不是低电平。
    3.5具有使能端的锁存器和触发器
持续援建也常接受一个死人输入当使能信号为低时，该时序元件保持它的状态，而与时钟无关。
3.6将逻辑合并到锁存器中，这样子可以减少时序开销
3.7，3.8，3.9，3.10，3.11（例子，看得不细）克拉斯半动态触发器，差分触发器，双边沿触发的触发器，抗辐照触发器，真单相时钟锁存器和触发器。
10.4，静态时序元件设计方法学
4.1元件选择
1.触发器具有相当大的时序开销，但由于他们简单，所以使用的非常普遍
2.脉冲锁存器比触发器快，并能提供一定的时间借用能力代价，适时保持时间增加，由于其钟控晶体管的数目很少，因此功耗较低，但由于脉冲锁存器较长的保持时间，使它不适于用在流水级之间，没有任何逻辑的流水线中。3.透明锁存器的时序开销也比触发器小，并且他们还应允许几乎半个时钟周期的时间借用，而很有吸引力，注意在每半个时钟周期上必须布置一个锁存器，数据可以在锁存器透明时的任何时刻到达锁存器。有多个输入信号的逻辑模块，必须保证每条信号路径在每周期中通过两个锁存器。
4.3，状态保持寄存器
    他能在单元的其余部分断电时接入到第二个电源上，以保持他们的状态，他们必须进行特殊的设计，使泄漏电流很小，并在他们输入变为无效时能防止他们的状态出错。
4.4电平转换触发器
  当电路在两种电压域之间从低电压转接到高电压时，需要有电平转换器。
10.6同步器
同步器电路接收可在任意时间变化的输入，并产生与同步器时钟对准的输出，由于输入有可能在同步器的间隙期间发生变化，所以同步器产生亚稳态输出的概率不为零。
6.1亚稳态
锁存器是一种双稳态器件，其他有两个稳定的状态0和1，在某些情况下，锁存器有可能恰好进入亚稳态，此时他的输出将处在0和1之间，一个不可预知的电平上。
6.3异步时钟域之间的通信
同步器通常应用在异步时钟域，即不共享同一时钟的电路模块之间的通信中。
6.4常见同步器错误
造成同步器性能很差的一个原因是采用了性能很差的锁存器或触发器。而另一个出错的原因是捕获了不一致的数据。
6.5仲裁器
仲裁器与同步器密切相关，它用来决定两个输入中哪一个首先到达。如果两个输入的间隙超过了某个间隙时间，那么应当应答第一个输入，如果这个间隙较小，那么只应答这两个输入中的一个，但选择哪一个是随意的。
10.8常见隐患与误区
没有完整的报告触发器的延时，没有检查保持时间，在设计中过迟选择时序控制策略，没有对异步输入进行同步处理，构造了不合格的同步器。


时钟偏斜：是指同样的时钟产生的多个子时钟信号之间的延时差异。skew通常是时钟相位上的不确定。由于时钟源到达不同寄存器所经历路径的驱动和负载的不同，时钟边沿的位置有所差异，因此就带来了skew。完成布局布线后，物理路径延时是固定的，所以在设计中考虑到时钟偏斜，就可以避免偏斜带来的影响。

https://www.jianshu.com/p/623b23cb046d?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes

